library(DOSE)
library(org.Hs.eg.db)
library(topGO)
library(clusterProfiler)
library(pathview)
install.packages("pathview")
source("https://bioconductor.org/biocLite.R")
biocLite("pathview")
biocLite("topGO")
library(pathview)
library(topGO)
data <- read.table("gene.list",header=TRUE)
data$GeneName <- as.character(data$GeneName)
transID = bitr(data$GeneName,
fromType="SYMBOL",
toType=c("ENSEMBL", "ENTREZID"),
OrgDb="org.Hs.eg.db"
)
BP <- enrichGO(transID$ENTREZID, "org.Hs.eg.db", keyType="ENTREZID", ont="BP", pvalueCutoff=0.05, pAdjustMethod="BH", qvalueCutoff=0.1)
BP <- setReadable(BP, OrgDb=org.Hs.eg.db)
barplot(BP, showCategory=12, title="GO_BP", font.size=8)
barplot(BP, showCategory=12, title="GO_BP", font.size=8, drop=T)
barplot(BP, showCategory=12, title="GO_BP", font.size=8, drop=T)
bp_bar <- barplot(BP, showCategory=12, title="GO_BP", font.size=8)
bp_bar
bp_bar + coord_trans()
bp_bar + coord_flip()
View(BP)
?barplot
BP$result
BP$result$ID
library(ggplot2)
p <- barplot(BP, showCategory=12, title="GO_BP", font.size=8)
View(p)
p
p + coord_flip()
p2 <- p + coord_flip()
p2
p2 <- p + scale_color_continuous(low='purple', high='green')
p2
barplot(BP, drop=TRUE, showCategory=12)
library(DOSE)
library(org.Hs.eg.db)
library(clusterProfiler)
library(ggplot2)
# import data
data <- read.table("gene.list",header=TRUE)
data$GeneName <- as.character(data$GeneName)
transID = bitr(data$GeneName,
fromType="SYMBOL",
toType=c("ENSEMBL", "ENTREZID"),
OrgDb="org.Hs.eg.db"
)
BP <- enrichGO(transID$ENTREZID, "org.Hs.eg.db", keyType="ENTREZID", ont="BP", pvalueCutoff=0.05, pAdjustMethod="BH", qvalueCutoff=0.1)
BP <- setReadable(BP, OrgDb=org.Hs.eg.db)
p <- barplot(BP, showCategory=12, title="GO_BP", font.size=8)
p
BP$ID
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
type=factor(rep("biological process", display_number[1]), levels="biological process"))
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
type=factor(rep("biological process", display_number[1]), levels="biological process"))
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
type=factor("biological process", levels="biological process"))
View(BP_df)
View(BP)
View(BP_df)
View(BP_df)
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
pvalue=BP$pvalue,
padj=BP$p.adjust,
type=factor("biological process", levels="biological process"))
head(BP_df)
head(BP_df)[12]
head(BP_df, n=12)
BP_df_plot <- head(BP_df, n=12)
View(BP_df_plot)
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$padj)) + geom_bar(stat="identity")
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
pvalue=BP$pvalue,
padj=BP$p.adjust,
count=BP$Count,
type=factor("biological process", levels="biological process"))
BP_df_plot <- head(BP_df, n=12)
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$padj)) + geom_bar(stat="count")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$count)) + geom_bar(stat="identity")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$count)) + geom_bar(stat="identity")
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
pvalue=BP$pvalue,
padj=BP$p.adjust,
GeneRatio=BP$GeneRatio,
type=factor("biological process", levels="biological process"))
BP_df <- data.frame(ID=BP$ID,
Description=BP$Description,
pvalue=BP$pvalue,
padj=BP$p.adjust,
GeneRatio=BP$GeneRatio,
type=factor("biological process", levels="biological process"))
BP_df_plot <- head(BP_df, n=12)
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio)) + geom_bar(stat="identity")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj, color="green")) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5), color="green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5), color="green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
scale_fill_manual("green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
scale_fill_manual("green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
scale_fill_manual(color="green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
scale_fill_manual(values="green")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
lab(fill="padj")
ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p <- ggplot(BP_df_plot, aes(x=BP_df_plot$Description, y=BP_df_plot$GeneRatio, fill=BP_df_plot$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p2 <- p + scale_fill_gradient(low = 'white', high = 'green')
p2
p2 <- p + scale_fill_gradient(low="#C1FFC1", high="#228B22")
p2
BP <- enrichGO(transID$ENTREZID, "org.Hs.eg.db", keyType="ENTREZID", ont="BP", pvalueCutoff=0.05, pAdjustMethod="BH", qvalueCutoff=0.1)
BP <- setReadable(BP, OrgDb=org.Hs.eg.db)
CC <- enrichGO(transID$ENTREZID, "org.Hs.eg.db", keyType="ENTREZID", ont="CC", pvalueCutoff=0.05, pAdjustMethod="BH", qvalueCutoff=0.1)
CC <- setReadable(CC, OrgDb=org.Hs.eg.db)
MF <- enrichGO(transID$ENTREZID, "org.Hs.eg.db", keyType="ENTREZID", ont="MF", pvalueCutoff=0.05, pAdjustMethod="BH", qvalueCutoff=0.1)
MF <- setReadable(MF, OrgDb=org.Hs.eg.db)
GO_df <- data.frame(ID=c(BP$ID, CC$ID, MF$ID),
Description=c(BP$Description, CC$Description, MF$Description),
pvalue=c(BP$pvalue, CC$pvalue, MF$pvalue),
padj=c(BP$p.adjust, CC$p.adjust, MF$adjust),
GeneRatio=c(BP$GeneRatio, CC$GeneRatio, MF$GeneRatio),
type=factor(c(rep("biological process", display_number[1]), rep("cellular component", display_number[2]),
rep("molecular function", display_number[3])), levels=c("biological process", "molecular function", "cellular component")))
View(CC)
BP$ID + "_BP"
#pzw
#20180830
#source("https://bioconductor.org/biocLite.R")
#biocLite("DOSE")
#biocLite("topGO")
#biocLite("clusterProfiler")
#biocLite("pathview")
library(DOSE)
library(org.Hs.eg.db)
library(clusterProfiler)
library(ggplot2)
data <- read.table("gene.list",header=TRUE)
data$GeneName <- as.character(data$GeneName)
transID = bitr(data$GeneName,
fromType="SYMBOL",
toType=c("ENSEMBL", "ENTREZID"),
OrgDb="org.Hs.eg.db"
)
# CC
CC <- enrichGO(transID$ENTREZID,
"org.Hs.eg.db",
keyType="ENTREZID",
ont="CC",
pvalueCutoff=0.05,
pAdjustMethod="BH",
qvalueCutoff=0.1
)
CC <- setReadable(CC, OrgDb=org.Hs.eg.db)
write.table(as.data.frame(CC@result), file="GO_CC.xls", sep="\t", row.names=F)
# MF
MF <- enrichGO(transID$ENTREZID,
"org.Hs.eg.db",
keyType="ENTREZID",
ont="MF",
pvalueCutoff=0.05,
pAdjustMethod="BH",
qvalueCutoff=0.1
)
MF <- setReadable(MF, OrgDb=org.Hs.eg.db)
write.table(as.data.frame(MF@result), file="GO_MF.xls", sep="\t", row.names=F)
# BP
BP <- enrichGO(transID$ENTREZID,
"org.Hs.eg.db",
keyType="ENTREZID",
ont="BP",
pvalueCutoff=0.05,
pAdjustMethod="BH",
qvalueCutoff=0.1
)
BP <- setReadable(BP, OrgDb=org.Hs.eg.db)
write.table(as.data.frame(BP@result), file="GO_BP.xls", sep="\t", row.names=F)
BP_df <- as.data.frame(BP@result)
View(BP_df)
CC_df <- as.data.frame(CC@result)
MF_df <- as.data.frame(MF@result)
BP_top5 <- head(BP_df, n=5)
View(BP_top5)
BP_df_plot <- read.table("GO_BP.xls", header=T)
View(BP_df_plot)
BP_df_plot2 <- head(BP_df_plot, n=5)
p <- ggplot(BP_df_plot, aes(x=BP_df_plot2$Description, y=BP_df_plot2$GeneRatio, fill=BP_df_plot2$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p2 <- p + scale_fill_gradient(low="#C1FFC1", high="#228B22")
p2
View(BP_df_plot2)
p
p <- ggplot(BP_df_plot, aes(x=BP_df_plot2$Description, y=BP_df_plot2$BgRatio, fill=BP_df_plot2$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p
?read.table
BP_df_plot <- read.table("GO_BP.xls", header=T, row.names=F)
BP_df_plot <- read.table("GO_BP.xls", header=T, rownames=F)
View(BP_df_plot)
BP_df_plot <- read.table("GO_BP.xls", header=T)
View(BP_df_plot)
BP_df_plot2 <- head(BP_df_plot, n=5)
View(BP_df_plot2)
p <- ggplot(BP_df_plot2, aes(x=BP_df_plot2$Description, y=BP_df_plot2$BgRatio, fill=BP_df_plot2$padj)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p
p <- ggplot(BP_df_plot2, aes(x=BP_df_plot2$Description, y=BP_df_plot2$BgRatio, fill=BP_df_plot2$p.adjust)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="padj")
p
p2 <- p + scale_fill_gradient(low="#C1FFC1", high="#228B22")
p2
CC_top5 <- head(CC_df, n=5)
MF_top5 <- head(MF_df, n=5)
View(CC_top5)
CC_top5$Description
class(CC_top5$Description)
View(BP_df_plot)
View(BP_top5)
View(BP_top5)
View(CC_top5)
for(i in CC_top5$Description){
i <- i + "_CC"
}
for(i in CC_top5$Description){
i <- paste(i, "CC", sep="_")
}
View(CC_top5)
View(BP_top5)
range(CC_top5$Description)
View(BP_top5)
dim(CC_top5)
CC_top5$Description[5,]
CC_top5$Description[5]
View(CC_top5)
for(i in range(5)){
CC_top5$Description[i] <- paste(CC_top5$Description[i] + "CC")
}
for(i in range(5)){
CC_top5$Description[i] <- paste(CC_top5$Description[i], "CC")
}
View(CC_top5)
range(5)
range(1:5)
for(i in range(1:5)){
CC_top5$Description[i] <- paste(CC_top5$Description[i], "CC")
}
CC_top5 <- head(CC_df, n=5)
View(CC_top5)
?range
for(i in c(1,2,3,4,5)){
CC_top5$Description[i] <- paste(CC_top5$Description[i], "CC")
}
CC_top5 <- head(CC_df, n=5)
MF_top5 <- head(MF_df, n=5)
BP_top5 <- head(BP_df, n=5)
for(i in c(1,2,3,4,5)){
CC_top5$Description[i] <- paste(CC_top5$Description[i], "CC")
MF_top5$Description[i] <- paste(MF_top5$Description[i], "MF")
BP_top5$Description[i] <- paste(BP_top5$Description[i], "BP")
}
View(CC_top5)
View(MF_top5)
View(BP_top5)
GO_df <- rbind(CC_top5, BP_top5)
View(GO_df)
GO_df <- rbind(CC_top5, MF_top5, BP_top5)
View(GO_df)
GO_df$BgRatio.split("/")
GO_df$BgRatio.Adjust <- GO_df$BgRatio.split("/")
GO_df$BgRatio.Adjust <- GO_df$BgRatio.split("/")[0]
BP <- setReadable(BP, OrgDb=org.Hs.eg.db)
BgRatio.Adjust <- strsplit(GO_df$BgRatio, "/")
View(BgRatio.Adjust)
BgRatio.Adjust <- strsplit(GO_df$BgRatio, "/")[1]
View(BgRatio.Adjust)
strsplit(GO_df$BgRatio, "/")
strsplit(GO_df$BgRatio, "/")[,1]
strsplit(GO_df$BgRatio, "/")[1,]
strsplit(GO_df$BgRatio, "/")[1]
strsplit(GO_df$BgRatio, "/")[1][1]
strsplit(GO_df$BgRatio, "/")[1]$1
strsplit(GO_df$BgRatio, "/")[1]$V1
BgRatio.Adjust <- strsplit(GO_df$BgRatio[1], "/")
BgRatio.Adjust <- strsplit(GO_df$BgRatio[1], "/")
View(BgRatio.Adjust)
BgRatio.Adjust <- strsplit(GO_df$BgRatio[1], "/")
View(BgRatio.Adjust)
BgRatio.Adjust <- strsplit(GO_df$BgRatio, "/")
View(BgRatio.Adjust)
BgRatio.Adjust[1]
class(BgRatio.Adjust[1])
BgRatio.Adjust[1][0]
BgRatio.Adjust[1][1]
BgRatio.Adjust[1][2]
BgRatio.Adjust <- strsplit(GO_df$BgRatio[1], "/")
View(BgRatio.Adjust)
GO_df$BgRatio[1]
View(BgRatio.Adjust)
BgRatio.Adj <- strsplit(GO_df$BgRatio[1], "/")
View(BgRatio.Adj)
BgRatio.Adj
BgRatio.Adj[1]
BgRatio.Adj[[1]
)
BgRatio.Adj[[1]]
BgRatio.Adj[[1]][1]
BgRatio.Adjust[[1]][1]
BgRatio.Adjust[[2]][1]
View(BgRatio.Adjust)
BgRatio.Adjust <- strsplit(GO_df$BgRatio, "/")
BgRatio[2]
BgRatio.Adjust[2]
BgRatio.Adjust[2][1]
BgRatio.Adjust[[2][1]
BgRatio.Adjust[[2]][1]
BgRatio.Adjust.split <- strsplit(GO_df$BgRatio, "/")
BgRatio.Adjust[[2]][1]/BgRatio.Adjust[[2]][2]
View(GO_df)
p <- ggplot(GO_df, aes(x=GO_df$Description, y=GO_df$BgRatio, fill=GO_df$p.adjust)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="p.adjust")
library(ggplot2)
p <- ggplot(GO_df, aes(x=GO_df$Description, y=GO_df$BgRatio, fill=GO_df$p.adjust)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="p.adjust")
p2 <- p + scale_fill_gradient(low="#C1FFC1", high="#228B22")
p2
library(org.Hs.eg.db)
library(clusterProfiler)
library(ggplot2)
data <- read.table("gene.list",header=TRUE)
data$GeneName <- as.character(data$GeneName)
transID = bitr(data$GeneName,
fromType="SYMBOL",
toType=c("ENSEMBL", "ENTREZID"),
OrgDb="org.Hs.eg.db"
)
CC <- enrichGO(transID$ENTREZID,
"org.Hs.eg.db",
keyType="ENTREZID",
ont="CC",
pvalueCutoff=0.05,
pAdjustMethod="BH",
qvalueCutoff=0.1
)
CC_df <- as.data.frame(CC@result)
CC_top5 <- head(CC_df, n=5)
View(CC_top5)
p <- ggplot(CC_top5, aes(x=CC_top5$Description, y=CC_top5$BgRatio, fill=CC_top5$p.adjust)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5)) +
ylab("sample number/background number") +
xlab("pathway name") +
labs(fill="p.adjust") +
scale_fill_gradient(low="#C1FFC1", high="#228B22")
p
barplot(CC_top5)
barplot(CC, showCategory=12, title="GO_CC", font.size=8)
barplot(CC, showCategory=5, title="GO_CC", font.size=8)
